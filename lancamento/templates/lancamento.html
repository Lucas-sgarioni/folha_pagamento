{% extends "base.html" %}
{% load bootstrap5 %}

{% block conteudo %}
<main class="container">
  <form method="get">
    {{ form.as_p }}
    <button type="submit">Filtrar</button>
  </form>

  {% if registros %}
  <form method="post">
    {% csrf_token %}

    <input type="hidden" name="nome" value="{{ form.cleaned_data.nome.id }}">
    <input type="hidden" name="mes" value="{{ form.cleaned_data.mes }}">
    <input type="hidden" name="ano" value="{{ form.cleaned_data.ano }}">

  <table class="table table-striped">
    <tr>
      <th>Data</th><th>Dia</th><th>Entrada Manhã</th><th>Saída Manhã</th>
      <th>Entrada Tarde</th><th>Saída Tarde</th><th>Dia todo como hora extra</th>
    </tr>
    {% for r in registros %}
    <tr>
      <td>{{ r.dia|date:"l" }}</td>
      <td>{{ r.dia|date:"d/m/Y" }}</td>
      <td>
        <input type="time" class="form-control" name="{{ r.dia|date:'Y-m-d' }}_entrada_manha"
              value="{{ r.lancamento.entrada_manha|time:'H:i' }}">
      </td>
      <td>
        <input type="time" class="form-control" name="{{ r.dia|date:'Y-m-d' }}_saida_manha"
              value="{{ r.lancamento.saida_manha|time:'H:i' }}">
      </td>
      <td>
        <input type="time" class="form-control" name="{{ r.dia|date:'Y-m-d' }}_entrada_tarde"
              value="{{ r.lancamento.entrada_tarde|time:'H:i' }}">
      </td>
      <td>
        <input type="time" class="form-control" name="{{ r.dia|date:'Y-m-d' }}_saida_tarde"
              value="{{ r.lancamento.saida_tarde|time:'H:i' }}">
      </td>
      <td class="text-center">
        <input type="checkbox" name="{{ r.dia|date:'Y-m-d' }}_hora_extra_total"
              {% if r.dia|date:'w' == '0' or r.dia|date:'w' == '6' %}checked{% endif %}>
      </td>
    </tr>
    {% endfor %}
  </table>

    <button type="submit">Salvar Lançamentos</button>
  </form>
  {% endif %}

</main>
{% endblock %}